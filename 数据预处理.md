# 数据预处理骚操作



### 数据分割

```python
data.drop(["Name","Ticket","Cabin"],inplace=True,axis=1) 
# 执行一次就行了，再执行就没有了
# 其中axis是对轴向1即列进行操作，inplace表示直接覆盖原来的data，否则如果为False就需要赋值给另一个对象
```

```py
# 处理缺失值，填补age
# 填补之前，空值的统计 data['Age'].isna().sum()

data['Age'] = data['Age'].fillna(data['Age'].mean())
```

```py
# 删除缺失值非常少的值的数据，即Embarked
# data = data.dropna(axis) 删除所有有缺失值的行或列，axis为0就是行，axis为1就是列，只要有缺失值就会删除
data = data.dropna() 
```

```py
(method)

Parameters
axis : {0 or 'index', 1 or 'columns'}, default 0
    Determine if rows or columns which contain missing values are removed.
0, or 'index' : Drop rows which contain missing values.
1, or 'columns' : Drop columns which contain missing value.

how : {'any', 'all'}, default 'any'
    Determine if row or column is removed from DataFrame, when we have at least one NA or all NA.
'any' : If any NA values are present, drop that row or column.
'all' : If all values are NA, drop that row or column.
thresh : int, optional

    Require that many non-NA values.
subset : column label or sequence of labels, optional
    Labels along other axis to consider, e.g. if you are dropping rows these would be a list of columns to include.
inplace : bool, default False
    If True, do operation inplace and return None.
```



```py
# 将分类类型改成数字
data['Embarked'] = data['Embarked'].apply(lambda x: labels.index(x)) 
#转换多分类变量为数值类型
```

```py
# (data['Sex'] == 'male').astype(int) 判断每一列的性别值，比将布尔值转换为int型数据后再重新赋值给Sex
data['Sex'] = (data['Sex'] == 'male').astype("int")
```

```py
# data.columns != 'Survived'
# 取出所有的行，列中名字不是'Survived'的值，布尔索引

x = data.iloc[:,data.columns != 'Survived']
```

```py
from sklearn.model_selection import train_test_split

Xtrain,Xtest,Ytrain,Ytest = train_test_split(x,y,test_size=0.3) #随机取出来的数据
```





### 作图

```py
tr = []
te = []
for i in range(10):
    clf = DecisionTreeClassifier(
        max_depth=i+1
        ,criterion='entropy'
    )
    clf = clf.fit(Xtrain,Ytrain)
    score_tr = clf.score(Xtrain,Ytrain)
    tr.append(score_tr)
    score_te = cross_val_score(clf,x,y,cv = 10).mean()
    te.append(score_te)
    
print(max(te))

plt.plot(range(1,11),tr,color = 'red',label = 'train')
plt.plot(range(1,11),te,color = 'yellow',label = 'test')
plt.xticks(range(1,11))
plt.legend()
plt.show()
```

